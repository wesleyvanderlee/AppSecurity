package com.wesley.VulnerabilityAlgorithm;

import java.util.ArrayList;
import java.util.List;

import com.bunq.apk.apkinfo;
import com.wesley.graph.Graph;
import com.wesley.graph.Vertex;

public class Error extends VulnerabilityIdentificationAlgorithm {

	public Error() {
		super("Error", "");
	}

	public void identify(Graph graph, apkinfo apkinfo) {
		this.setIdentified(0);
		List<Vertex> R = new ArrayList<Vertex>();

		for (Vertex v : graph.getVertexes()) {
			if (v.hasError()) {
				R.add(v);
			}

		}
		// All states are checked
		if (!R.isEmpty()) {
			findings.add("The following states are error states: " + R.toString());
			this.setIdentified(1); // Likely vulnerability is present
		}
	}
}
